# 📊 用户数据格式使用指南

## 您的标准数据格式

您的数据格式已经标准化为：
```csv
symbol,date,open,high,low,close,volume,open_interest,turnover,settle,pre_settle,variety
IF1005,2010-4-16,3450,3488,3413.2,3415.6,48988,2702,5053880,3431.2,3399,IF
```

## 🎯 系统完全支持您的格式

### 自动识别功能
- ✅ **自动列名识别**: 系统会自动识别 `symbol` 列并映射为 `contract`
- ✅ **智能映射**: 无需手动配置列映射
- ✅ **完整支持**: 支持所有12个字段

### 支持的字段说明

| 字段名 | 描述 | 示例 | 是否必需 |
|--------|------|------|----------|
| symbol | 期货合约代码 | IF1005 | ✅ 必需 |
| date | 交易日期 | 2010-4-16 | ✅ 必需 |
| open | 开盘价 | 3450 | ✅ 必需 |
| high | 最高价 | 3488 | ✅ 必需 |
| low | 最低价 | 3413.2 | ✅ 必需 |
| close | 收盘价 | 3415.6 | ✅ 必需 |
| volume | 成交量 | 48988 | ✅ 必需 |
| open_interest | 持仓量 | 2702 | ✅ 必需 |
| turnover | 成交金额 | 5053880 | 🔶 可选 |
| settle | 结算价 | 3431.2 | 🔶 可选 |
| pre_settle | 前结算价 | 3399 | 🔶 可选 |
| variety | 品种 | IF | 🔶 可选 |

## 🚀 使用步骤

### 第一步：准备数据
确保您的CSV文件格式如下：
```csv
symbol,date,open,high,low,close,volume,open_interest,turnover,settle,pre_settle,variety
IF1005,2010-4-16,3450,3488,3413.2,3415.6,48988,2702,5053880,3431.2,3399,IF
IF1006,2010-4-16,3460,3490,3420.0,3425.0,52000,2800,5200000,3440.0,3400,IF
```

### 第二步：启动应用程序
```bash
python3 -m streamlit run app.py
```

### 第三步：上传数据
1. 点击"选择文件"
2. 选择您的CSV文件
3. 系统会自动检测列映射
4. 确认映射配置（通常无需修改）
5. 点击"导入数据"

### 第四步：验证导入
- 查看数据概览
- 确认数据行数和列数正确
- 检查数据完整性

## 🔧 自动列映射

系统会自动将您的列名映射为内部格式：

| 您的列名 | 系统内部列名 | 说明 |
|----------|-------------|------|
| symbol | contract | 自动映射 |
| date | date | 保持不变 |
| open | open | 保持不变 |
| high | high | 保持不变 |
| low | low | 保持不变 |
| close | close | 保持不变 |
| volume | volume | 保持不变 |
| open_interest | open_interest | 保持不变 |
| turnover | turnover | 保持不变 |
| settle | settle | 保持不变 |
| pre_settle | pre_settle | 保持不变 |
| variety | variety | 保持不变 |

## 📈 增强功能

### 基于可选字段的额外特征
如果您的数据包含可选字段，系统会自动生成额外的技术指标：

- **成交金额指标**:
  - 成交金额移动平均
  - 成交金额比率
  - 平均成交价

- **结算价指标**:
  - 结算价变动率
  - 收盘价相对结算价位置
  - 结算价相对前结算价变动

### 品种分类
`variety` 字段用于品种分类，支持多品种分析。

## 🧪 测试您的数据

### 快速测试
```bash
python3 test_your_data.py your_file.csv
```

### 完整测试
```bash
python3 test_user_format.py
```

## ⚠️ 注意事项

### 数据格式要求
1. **日期格式**: 支持 `YYYY-M-D` 或 `YYYY-MM-DD`
2. **数值格式**: 确保价格和数量为数值类型
3. **编码格式**: 推荐使用UTF-8编码
4. **分隔符**: 使用逗号分隔

### 常见问题
1. **日期格式错误**: 确保日期格式正确
2. **数值包含文本**: 检查价格和数量列
3. **编码问题**: 使用UTF-8编码保存文件
4. **空行问题**: 删除CSV文件中的空行

## 📋 数据质量检查

### 必需字段检查
- ✅ symbol: 期货合约代码
- ✅ date: 交易日期
- ✅ open/high/low/close: 价格数据
- ✅ volume: 成交量
- ✅ open_interest: 持仓量

### 数据完整性
- 确保无缺失值
- 检查数据范围合理性
- 验证价格逻辑（high >= low）

## 🎉 优势

### 相比其他格式的优势
1. **标准化**: 统一的列名格式
2. **完整性**: 包含所有必要和可选字段
3. **兼容性**: 与多种数据源兼容
4. **扩展性**: 支持未来字段扩展

### 系统优化
1. **自动识别**: 无需手动配置
2. **智能映射**: 自动处理列名映射
3. **错误处理**: 友好的错误提示
4. **性能优化**: 高效的数据处理

## 📞 技术支持

如果遇到问题，请提供：
1. CSV文件的前几行数据
2. 完整的错误信息
3. 系统版本信息

---

**格式版本**: v1.0  
**最后更新**: 2024-01-01  
**兼容性**: 完全向后兼容